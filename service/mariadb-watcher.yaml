service:
  name: proxysql
  containers:
    - name: watcher
      image: watcher
      probes:
        readiness: "true"
        liveness: "true"
      daemon:
        command: /usr/bin/watch_changes -prefix /pxc-cluster/{{ cluster_name }} -proxy_user {{ mysql-proxy-user }} -proxy_pass {{ mysql-proxy-password }} -proxy_address "pxc-service" -root_pass {{ mysql-root-password }} -etcd_service {{ discovery-service }}
      env:
         - name: MYSQL_ROOT_PASSWORD
           valueFrom:
             configMapKeyRef:
               name: percona
               key: mysql-root-password
         - name: DISCOVERY_SERVICE
           valueFrom:
             configMapKeyRef:
               name: percona
               key: discovery-service
         - name: CLUSTER_NAME
           valueFrom:
             configMapKeyRef:
               name: percona
               key: cluster-name
         - name: XTRABACKUP_PASSWORD
           valueFrom:
             configMapKeyRef:
               name: percona
               key: xtrabackup-password

